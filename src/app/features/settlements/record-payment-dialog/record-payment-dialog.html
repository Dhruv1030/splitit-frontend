<div class="record-payment-dialog">
  <h2 mat-dialog-title>
    <mat-icon>check_circle</mat-icon>
    Record Payment
  </h2>

  <mat-dialog-content>
    <!-- Payment Summary -->
    <div class="payment-summary">
      <div class="summary-header">
        <mat-icon>receipt</mat-icon>
        <span>Payment Details</span>
      </div>
      
      <div class="summary-content">
        <div class="summary-row">
          <span class="label">From:</span>
          <span class="value payer">{{ data.suggestion.payerName }}</span>
        </div>
        
        <div class="summary-row">
          <span class="label">To:</span>
          <span class="value payee">{{ data.suggestion.payeeName }}</span>
        </div>
        
        <div class="summary-row amount-row">
          <span class="label">Amount:</span>
          <span class="value amount">{{ formatCurrency(data.suggestion.amount) }}</span>
        </div>
      </div>
    </div>

    <!-- Payment Form -->
    <form [formGroup]="paymentForm" class="payment-form">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Amount</mat-label>
        <input matInput type="number" formControlName="amount" step="0.01">
        <span matTextPrefix>{{ data.suggestion.currency }}&nbsp;</span>
        <mat-icon matSuffix>account_balance_wallet</mat-icon>
        <mat-hint>This amount is locked based on the settlement suggestion</mat-hint>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Payment Method</mat-label>
        <mat-select formControlName="paymentMethod">
          <mat-option *ngFor="let method of paymentMethods" [value]="method.value">
            <mat-icon class="method-icon">{{ method.icon }}</mat-icon>
            {{ method.label }}
          </mat-option>
        </mat-select>
        <mat-icon matSuffix>payment</mat-icon>
        <mat-error *ngIf="paymentForm.get('paymentMethod')?.hasError('required')">
          Please select a payment method
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Transaction ID (Optional)</mat-label>
        <input matInput formControlName="transactionId" placeholder="e.g., UPI Ref: 123456789">
        <mat-icon matSuffix>tag</mat-icon>
        <mat-hint>Reference number for tracking</mat-hint>
      </mat-form-field>

      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Notes (Optional)</mat-label>
        <textarea matInput formControlName="notes" rows="3" placeholder="Add any additional notes..."></textarea>
        <mat-icon matSuffix>note</mat-icon>
      </mat-form-field>
    </form>

    <div class="info-note">
      <mat-icon>info</mat-icon>
      <p>
        Recording this payment will update the group balances. 
        Make sure the payment has been completed before recording it.
      </p>
    </div>
  </mat-dialog-content>

  <mat-dialog-actions align="end">
    <button mat-button (click)="onCancel()" [disabled]="loading">
      Cancel
    </button>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onSubmit()" 
      [disabled]="loading || paymentForm.invalid">
      <mat-icon *ngIf="!loading">check</mat-icon>
      <mat-spinner *ngIf="loading" diameter="20"></mat-spinner>
      {{ loading ? 'Recording...' : 'Record Payment' }}
    </button>
  </mat-dialog-actions>
</div>
